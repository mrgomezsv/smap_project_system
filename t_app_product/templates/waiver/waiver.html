{% extends 'base.html' %}

{% block content %}
<div class="container mt-5">
    <h2>Administración de Datos de Waiver</h2>

    <!-- Nav tabs -->
    <ul class="nav nav-tabs" id="waiverTabs" role="tablist">
        <li class="nav-item" role="presentation">
            <a class="nav-link active" id="registered-users-tab" data-bs-toggle="tab" href="#registered-users" role="tab" aria-controls="registered-users" aria-selected="true">
                Clientes Registrados en el Waiver
            </a>
        </li>
        <li class="nav-item" role="presentation">
            <a class="nav-link" id="add-email-tab" data-bs-toggle="tab" href="#add-email" role="tab" aria-controls="add-email" aria-selected="false">
                Agregar Colaborador
            </a>
        </li>
    </ul>

    <!-- Tab content -->
    <div class="tab-content mt-3" id="waiverTabsContent">
        <!-- Pestaña de Clientes Registrados en el Waiver -->
        <div class="tab-pane fade show active" id="registered-users" role="tabpanel" aria-labelledby="registered-users-tab">
            <h3>Clientes Registrados en el Waiver</h3>
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Codigo QR Asociado</th>
                        <th>Nombre del Titular</th>
                        <th>Nombre del Familiar</th>
                        <th>Edad del Familiar</th>
                        <th>Fecha de Registro</th>
                        <th>Correo Electronico</th>
                    </tr>
                </thead>
                <tbody>
                    {% for cliente in waiver_clientes %}
                        <tr>
                            <td>{{ cliente.id }}</td>
                            <td>{{ cliente.user_id }}</td>
                            <td>{{ cliente.user_name }}</td>
                            <td>{{ cliente.relative_name }}</td>
                            <td>{{ cliente.relative_age }}</td>
                            <td>{{ cliente.timestamp }}</td>
                            <td>{{ cliente.user_email }}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Pestaña de Agregar Correo Electrónico -->
        <div class="tab-pane fade" id="add-email" role="tabpanel" aria-labelledby="add-email-tab">
    <h3>Agregar Colaborador</h3>
    <p>En este apartado agregaremos los correos electrónicos de los colaboradores que validarán (escanearán) el QR de cada cliente en la APP.</p>
    <form method="post" novalidate>
        {% csrf_token %}
        {{ form.as_p }}  <!-- Renderizamos el formulario -->
        <button type="submit" class="btn btn-primary">Agregar</button>
    </form>

    <hr>

    <!-- Tabla de correos electrónicos -->
    <h3>Lista de Correos Electrónicos Autorizados para Validar QR en la APP</h3>
    <p>Este es el listado de personas que tendrán acceso a Custom Waiver Validator en la APP. Por el momento no se puede borrar o editar esta lista, pero se podrá próximamente, por el momento solo se puede agregar.</p>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Email</th>
                <th>Fecha de Creación</th>
            </tr>
        </thead>
        <tbody>
            {% for validator in waiver_validators %}
                <tr>
                    <td>{{ validator.email }}</td>
                    <td>{{ validator.created_at }}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

    </div>
</div>
{% endblock %}
